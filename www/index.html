<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
	<script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
	<link rel="stylesheet" type="text/css" href="css/style.css" />
	<link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
	<script src="http://maps.googleapis.com/maps/api/js"></script>
	<script>
	$( "#leftpanel2" ).panel( "open");
	</script>
</head>
<body>
	<div data-role="page" id="page1">
	<script type="text/javascript" src="js/openfb.js"></script>
		<div data-role="panel" id="leftpanel2" data-position="left" data-display="push" data-dismissible="true" data-theme="a">
			<div class="profile_area">
				<div class="profile_picture">
					<img id="userPic"/>
				</div>
				<div class="user_info">
					<p id="userName"></p>
				</div>
			</div>
			<ul>
				<li>
					<a class="active" href="index.html">Record</a>
				</li>
				<li>
					<a href="my_routes.html">My Routes</a>
				</li>
				<li>
					<a href="view_routes.html">View Routes</a>
				</li>
				<li>
					<button id="fbLogin" class="btn btn-block" onclick="login()">Login with Facebook</button>
				</li>
			</ul>
		</div>

		<div data-role="header">
			<a href="#leftpanel2" data-role="button" data-inline="true" data-mini="true"><i class="fa fa-bars"></i></a>
			<h1>Record</h1>
		</div>

		<div data-role="main" class="ui-content">
			<div class="content_container">
				<div class="ui-grid-a">
					<div class="ui-block-a home_btns">
						<p>Distance <br/><span id="distance" class="value">0.0 km</span></p>
					</div>
					<div class="ui-block-b home_btns">
						<p>Duration <br/><span class="value" id="duration">00:00:00</span></p>
					</div>
				</div>
			</div>
			<button id="stopWalk" onClick="stopSession()" style="display: none;">Finish</button>
			<div id="mapPlaceholder" style="height:100%; width: 100%;"></div>
		</div>

		<div data-role="footer">
			<div class="record_footer">
				<div class="ui-grid-b">
					<div class="ui-block-a">
						<button class="camera_button" onClick="capturePhoto()">
							<i class="fa fa-camera size-36"></i>
						</button>
					</div>
					<div class="ui-block-b">
						<button id="watchButton" onClick="track(this)">
							START
						</button>
					</div>
					<div class="ui-block-c">
						<button class="map_marker_button" id="map_marker" onClick="addMapMarker()">
							<i class="fa fa-map-marker size-36"></i>
						</button>
					</div>
				</div>
			</div>
		</div>
	<script type="text/javascript" src="js/main.js"></script>
	</div>

	<div data-role="page" id="map-page">
		<div data-role="panel" id="leftpanel2" data-position="left" data-display="push" data-dismissible="true" data-theme="a">
			<div class="profile_area">
				<div class="profile_picture">
					<img id="userPic"/>
				</div>
				<div class="user_info">
					<p id="userName"></p>
				</div>
			</div>
			<ul>
				<li>
					<a class="active" href="index.html">Record</a>
				</li>
				<li>
					<a href="my_routes.html">My Routes</a>
				</li>
				<li>
					<a href="view_routes.html">View Routes</a>
				</li>
				<li>
					<button id="fbLogin" class="btn btn-block" onclick="login()">Login with Facebook</button>
				</li>
			</ul>
		</div>

		<div data-role="header">
			<a href="#leftpanel2" data-role="button" data-inline="true" data-mini="true"><i class="fa fa-bars"></i></a>
			<h1>Walk Summary</h1>
		</div>

		<div data-role="main" class="ui-content">
			<div class="map">
				<div id="finishedRoute" style="height:150px; width: 100%;"></div>
				<div class="ui-grid-a">
					<div class="ui-block-a home_btns">
						<div class="ui-block-a finishedDistance">
							<i class="fa fa-map-marker"></i>
						</div>
						<div class="ui-block-b">
							<p>Distance <br/><span id="finalDistance" class="value"></span></p>
						</div>
					</div>
					<div class="ui-block-b home_btns">
						<div class="ui-block-a finishedDistance">
							<i class="fa fa-clock-o"></i>
						</div>
						<div class="ui-block-b finishedDuration">
							<p>Duration <br/><span class="value" id="finalDuration"></span></p>
						</div>
					</div>
				</div>
				<span class="horizontalSplitter"></span>
				<div id="walkDescription" contenteditable="true" data-text="Add a description"></div>
				<span class="horizontalSplitter"></span>
				<button id="stopWalk" onClick="getPicture()">Add Photographs</button>
				<div id="photosContainer" class="horizontal-images">
					<div class="photos">
					<a href="#transitionExample" data-transition="none" data-role="button" data-inline="true" data-rel="dialog">No transition</a>
					<div id="transitionExample" data-role="popup" data-transition="flip">
					  <p>This is some text for the transition example</p>
					</div>
					</div>
				</div>
				<button id="buttonDone" onClick="saveInfo()">Save Information</button>
			</div><!-- /content -->
		</div>

		<div data-role="footer"></div>
		<script type="text/javascript" src="js/finishedWalk.js"></script>
		<link rel="stylesheet" href="css/jquery.mCustomScrollbar.css">
		<script type="text/javascript" src="js/jquery.mCustomScrollbar.min.js"></script>
	</div>



<script type="text/javascript" src="cordova.js"></script>
        <script>

             // Defaults to sessionStorage for storing the Facebook token
             openFB.init({appId: '292811390842470'});

            //  Uncomment the line below to store the Facebook token in localStorage instead of sessionStorage
            //  openFB.init({appId: 'YOUR_FB_APP_ID', tokenStore: window.localStorage});

            function login() {
                openFB.login(
                        function(response) {
                            if(response.status === 'connected') {
                                alert('Facebook login succeeded, got access token: ' + response.authResponse.token);
                            } else {
                                alert('Facebook login failed: ' + response.error);
                            }
                        }, {scope: 'email,read_stream,publish_stream'});
                getInfo();
            }

            function getInfo() {
                openFB.api({
                    path: '/me',
                    success: function(data) {
                        console.log(JSON.stringify(data));
                        document.getElementById("userName").innerHTML = data.name;
                        document.getElementById("userPic").src = 'http://graph.facebook.com/' + data.id + '/picture?type=small';
                    },
                    error: errorHandler});
            }

            // function share() {
            //     openFB.api({
            //         method: 'POST',
            //         path: '/me/feed',
            //         params: {
            //             message: document.getElementById('Message').value || 'Testing Facebook APIs'
            //         },
            //         success: function() {
            //             alert('the item was posted on Facebook');
            //         },
            //         error: errorHandler});
            // }

            // function revoke() {
            //     openFB.revokePermissions(
            //             function() {
            //                 alert('Permissions revoked');
            //             },
            //             errorHandler);
            // }

            function logout() {
                openFB.logout(
                        function() {
                            alert('Logout successful');
                        },
                        errorHandler);
            }

            function errorHandler(error) {
                alert(error.message);
            }
        </script>
</body>
</html>
